<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS Librer√≠a - Inventario</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body class="page-admin">

    <header>
        <h1>üìö Inventario y Triggers</h1>
        <div class="nav-links">
            <span class="user-info">üë§ <span id="nombre-usuario">Cargando...</span></span>
            
            <a href="/ventas.html" class="link-azul">üõí Caja</a>
            <a href="/reportes.html" class="link-azul">üìà Reportes</a>
            <a href="/empleados.html" class="link-azul">üëî Empleados</a>
            <button onclick="logout()" class="btn-danger">Cerrar Sesi√≥n</button>
        </div>
    </header>

    <div class="report-container" style="padding-top: 20px;">

        <div style="display: flex; justify-content: flex-end; margin-bottom: 20px;">
            <button onclick="toggleFormulario()" style="background: #28a745; color: white; padding: 12px 20px; font-size: 1em; display: flex; align-items: center; gap: 8px;">
                ‚ûï Agregar Nuevo Libro
            </button>
        </div>

        <div id="form-agregar" class="report-card" style="display: none;">
            <div style="border-bottom: 1px solid #eee; margin-bottom: 15px; padding-bottom: 10px;">
                <h3 id="form-titulo" style="margin: 0; color: #28a745;">Nuevo Libro</h3>
                <small style="color: #666;">Ingresa los datos del producto.</small>
            </div>
            
            <input type="hidden" id="edit-id"> 

            <div class="form-row">
                <div>
                    <label>ISBN / C√≥digo de Barras</label>
                    <input type="text" id="new-isbn" placeholder="Escanea o escribe..." required>
                </div>
                <div>
                    <label>T√≠tulo del Libro</label>
                    <input type="text" id="new-titulo" placeholder="Ej. El Principito" required>
                </div>
            </div>

            <div class="form-row">
                <div style="flex: 2;">
                    <label>Descripci√≥n / Autor</label>
                    <input type="text" id="new-desc" placeholder="Ej. Antoine de Saint-Exup√©ry">
                </div>
                <div>
                    <label>Precio Venta ($)</label>
                    <input type="number" id="new-precio" placeholder="0.00" step="0.50" required>
                </div>
                <div>
                    <label>Stock Inicial</label>
                    <input type="number" id="new-stock" placeholder="1" value="1" required>
                </div>
            </div>

            <div style="text-align: right; margin-top: 10px;">
                <button onclick="limpiarFormulario()" style="background: #6c757d; color: white; margin-right: 10px;">Cancelar</button>
                <button onclick="guardarProducto()" id="btn-submit" style="background: #007bff; color: white;">üíæ Guardar Libro</button>
            </div>
        </div>
        
        <div class="report-card">
            <table class="table-inventory">
                <thead>
                    <tr>
                        <th width="15%">ISBN</th>
                        <th width="30%">T√≠tulo</th>
                        <th width="25%">Autor (Desc)</th>
                        <th width="10%" class="text-right">Precio</th>
                        <th width="10%" class="text-center">Stock</th>
                        <th width="10%" class="text-center">Acciones</th>
                    </tr>
                </thead>
                <tbody id="tabla-productos">
                    </tbody>
            </table>
        </div>

        <div class="audit-section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h2 style="margin: 0; display: flex; align-items: center; gap: 10px;">
                    üïµÔ∏è Auditor√≠a de Cambios <span style="font-size: 0.6em; background: #333; color: #fff; padding: 2px 6px; border-radius: 4px;">TRIGGERS ACTIVOS</span>
                </h2>
                <button onclick="cargarAuditoria()" style="background: #333; color: white;">üîÑ Actualizar Historial</button>
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th width="20%">Fecha</th>
                        <th width="10%">Acci√≥n</th>
                        <th width="25%">Valor Anterior</th>
                        <th width="25%">Valor Nuevo</th>
                        <th width="20%">Usuario</th>
                    </tr>
                </thead>
                <tbody id="tabla-auditoria">
                    </tbody>
            </table>
        </div>

    </div>

    <script src="js/main.js"></script>
</body>
</html>